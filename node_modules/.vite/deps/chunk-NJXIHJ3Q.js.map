{
  "version": 3,
  "sources": ["../../@vaadin/a11y-base/src/field-aria-controller.js"],
  "sourcesContent": ["/**\n * @license\n * Copyright (c) 2021 - 2024 Vaadin Ltd.\n * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n */\nimport { removeAriaIDReference, restoreGeneratedAriaIDReference, setAriaIDReference } from './aria-id-reference.js';\n\n/**\n * A controller for managing ARIA attributes for a field element:\n * either the component itself or slotted `<input>` element.\n */\nexport class FieldAriaController {\n  constructor(host) {\n    this.host = host;\n    this.__required = false;\n  }\n\n  /**\n   * Sets a target element to which ARIA attributes are added.\n   *\n   * @param {HTMLElement} target\n   */\n  setTarget(target) {\n    this.__target = target;\n    this.__setAriaRequiredAttribute(this.__required);\n    // We need to make sure that value in __labelId is stored\n    this.__setLabelIdToAriaAttribute(this.__labelId, this.__labelId);\n    if (this.__labelIdFromUser != null) {\n      this.__setLabelIdToAriaAttribute(this.__labelIdFromUser, this.__labelIdFromUser, true);\n    }\n    this.__setErrorIdToAriaAttribute(this.__errorId);\n    this.__setHelperIdToAriaAttribute(this.__helperId);\n    this.setAriaLabel(this.__label);\n  }\n\n  /**\n   * Toggles the `aria-required` attribute on the target element\n   * if the target is the host component (e.g. a field group).\n   * Otherwise, it does nothing.\n   *\n   * @param {boolean} required\n   */\n  setRequired(required) {\n    this.__setAriaRequiredAttribute(required);\n    this.__required = required;\n  }\n\n  /**\n   * Defines the `aria-label` attribute of the target element.\n   *\n   * To remove the attribute, pass `null` as `label`.\n   *\n   * @param {string | null | undefined} label\n   */\n  setAriaLabel(label) {\n    this.__setAriaLabelToAttribute(label);\n    this.__label = label;\n  }\n\n  /**\n   * Links the target element with a slotted label element\n   * via the target's attribute `aria-labelledby`.\n   *\n   * To unlink the previous slotted label element, pass `null` as `labelId`.\n   *\n   * @param {string | null} labelId\n   */\n  setLabelId(labelId, fromUser = false) {\n    const oldLabelId = fromUser ? this.__labelIdFromUser : this.__labelId;\n    this.__setLabelIdToAriaAttribute(labelId, oldLabelId, fromUser);\n    if (fromUser) {\n      this.__labelIdFromUser = labelId;\n    } else {\n      this.__labelId = labelId;\n    }\n  }\n\n  /**\n   * Links the target element with a slotted error element via the target's attribute:\n   * - `aria-labelledby` if the target is the host component (e.g a field group).\n   * - `aria-describedby` otherwise.\n   *\n   * To unlink the previous slotted error element, pass `null` as `errorId`.\n   *\n   * @param {string | null} errorId\n   */\n  setErrorId(errorId) {\n    this.__setErrorIdToAriaAttribute(errorId, this.__errorId);\n    this.__errorId = errorId;\n  }\n\n  /**\n   * Links the target element with a slotted helper element via the target's attribute:\n   * - `aria-labelledby` if the target is the host component (e.g a field group).\n   * - `aria-describedby` otherwise.\n   *\n   * To unlink the previous slotted helper element, pass `null` as `helperId`.\n   *\n   * @param {string | null} helperId\n   */\n  setHelperId(helperId) {\n    this.__setHelperIdToAriaAttribute(helperId, this.__helperId);\n    this.__helperId = helperId;\n  }\n\n  /**\n   * @param {string | null | undefined} label\n   * @private\n   * */\n  __setAriaLabelToAttribute(label) {\n    if (!this.__target) {\n      return;\n    }\n    if (label) {\n      removeAriaIDReference(this.__target, 'aria-labelledby');\n      this.__target.setAttribute('aria-label', label);\n    } else if (this.__label) {\n      restoreGeneratedAriaIDReference(this.__target, 'aria-labelledby');\n      this.__target.removeAttribute('aria-label');\n    }\n  }\n\n  /**\n   * @param {string | null | undefined} labelId\n   * @param {string | null | undefined} oldLabelId\n   * @param {boolean | null | undefined} fromUser\n   * @private\n   */\n  __setLabelIdToAriaAttribute(labelId, oldLabelId, fromUser) {\n    setAriaIDReference(this.__target, 'aria-labelledby', { newId: labelId, oldId: oldLabelId, fromUser });\n  }\n\n  /**\n   * @param {string | null | undefined} errorId\n   * @param {string | null | undefined} oldErrorId\n   * @private\n   */\n  __setErrorIdToAriaAttribute(errorId, oldErrorId) {\n    setAriaIDReference(this.__target, 'aria-describedby', { newId: errorId, oldId: oldErrorId, fromUser: false });\n  }\n\n  /**\n   * @param {string | null | undefined} helperId\n   * @param {string | null | undefined} oldHelperId\n   * @private\n   */\n  __setHelperIdToAriaAttribute(helperId, oldHelperId) {\n    setAriaIDReference(this.__target, 'aria-describedby', { newId: helperId, oldId: oldHelperId, fromUser: false });\n  }\n\n  /**\n   * @param {boolean} required\n   * @private\n   */\n  __setAriaRequiredAttribute(required) {\n    if (!this.__target) {\n      return;\n    }\n\n    if (['input', 'textarea'].includes(this.__target.localName)) {\n      // Native <input> or <textarea>, required is enough\n      return;\n    }\n\n    if (required) {\n      this.__target.setAttribute('aria-required', 'true');\n    } else {\n      this.__target.removeAttribute('aria-required');\n    }\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
